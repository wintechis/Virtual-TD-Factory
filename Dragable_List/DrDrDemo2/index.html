<!DOCTYPE html>
<html>
<head>
    <title>My Drag-and-Drop Example</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
    <div class="example-parent">
        <h1>Movement list</h1>
        <div class="example-origin">
            Movements
            <div id="draggable-1"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">grab_green</div>
            <div id="draggable-2"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">grab_yellow</div>
            <div id="draggable-3"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">grab_red</div>
            <div id="draggable-4"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">grab_blue</div>
            <div id="draggable-5"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J1plus</div>
            <div id="draggable-6"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J1minus</div>
            <div id="draggable-7"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J2plus</div>
            <div id="draggable-8"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J2minus</div>
            <!--<div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J3plus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J3minus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J4plus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J4minus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J5plus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J5minus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J6plus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">J6minus</div>-->
            <!--<div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">Speed500plus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">Speed500minus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">Step5plus</div>
            <div id="draggable[]"
                 class="example-draggable"
                 draggable="true"
                 ondragstart="onDragStart(event);">Step5minus</div>-->
        </div>

        <div class="example-dropzone"
             ondragover="onDragOver(event);"
             ondrop="onDrop(event);">
        </div>
    </div>
    <div class="text-center">
        <button type="button" id="generateJSON" class="btn btn-info">generate and post JSON</button>

    </div>
    <div class="col-md-6">
        <h4 class="text-center">JSON</h4>
        <pre id="printCode"></pre>
    </div>
    <script src="script.js"></script>
    <script>

        // generate product JSON
        $('#generateJSON').click(function () {

            let data = {};

            var titles = $('div[class^=example-dropzone] > div[id^=draggable]').map(function (idx, elem) {
                return $(elem).text();
            }).get();

            //titles = $('div.example-dropzone').children().text();
            console.log(titles)

            data['Action'] = 'action_sequence';
            data['Action_Steps'] = titles;

            // encode to JSON format
            var products_json = JSON.stringify(data, null, '\t');
            console.log(data['products_json'])

            $('#printCode').html(products_json);

            var xhr = new XMLHttpRequest();
            var url = "http://localhost:3000/Actions/test";
            xhr.open("POST", url, true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    console.log(xhr.status);
                    console.log(xhr.responseText);
                }
            };
            xhr.send(products_json);
        });
    </script>

</body>
</html>